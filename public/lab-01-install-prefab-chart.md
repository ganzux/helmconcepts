# Lab 01: Install a Prefab Helm Chart

## A. Prerequisites

1. Install Docker
# To-do

2. Install K3d
# To-do

3. Install kubectl
# To-do

4. Install Helm

```
curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash
```
```
helm -v
```

## Deploy with Helm

1. Add a new helm repository
   
```
helm repo add bitnami https://charts.bitnami.com/bitnami
```

2. Update Helm.

```
helm repo update
```

3. Install PostgreSQL via helm chart.

```
helm install mypostgresql bitnami/postgresql
```

4. Save the PostgreSQL service's autogenerated password.

```
export POSTGRES_PASSWORD=$(kubectl get secret --namespace default mypostgresql -o jsonpath="{.data.postgres-password}" | base64 -d)
```

5. Connect to the database.

```
kubectl run mypostgresql-client --rm --tty -i --restart='Never' --namespace default --image docker.io/bitnami/postgresql:16.2.0-debian-12-r8 --env="PGPASSWORD=$POSTGRES_PASSWORD" --command -- psql --host mypostgresql -U postgres -d postgres -p 5432
```

6. Verify your connection to the database from the postgres command prompt.

```
\conninfo
```

7. Quit out of postgres.

```
\q
```

8. Uninstall the helm chart.

```
helm uninstall mypostgresql
```

9. For the PostGres helm chart, deletion doesn't quite delete all Kubernetes resources. Check if there is any dangling storage.

```
kubectl get pvc
```

10. Delete the leftover persistent volume claim.

```
kubectl delete pvc data-mypostgresql-0
```














